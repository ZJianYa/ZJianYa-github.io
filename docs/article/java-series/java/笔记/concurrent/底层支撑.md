| 中文翻译     | 术语                   | 解释                                                                                                                                                                                                                          |
| ------------ | ---------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 内存屏障     | memory barriers        | 一组处理器指令，实现对内存操作的顺序限制                                                                                                                                                                                      |
| 原子操作     | Atomic operations      | 不可中断的一个或者一系列操作                                                                                                                                                                                                  |
| 缓冲行       | cache line             | 缓冲中可以分配的最小存储单元。处理器填写缓存线时，会加载整个缓存线，需要使用多个主内存读周期                                                                                                                                  |
| 缓冲行填充   | cache line fill        | 如果处理器识别到从内存中读取操作数是可缓存的，可以将缓存行读取并放入到缓存（L1,L2,L3的或所有）                                                                                                                                |
| 缓存命中     |                        |                                                                                                                                                                                                                               |
| 写命中       |                        |                                                                                                                                                                                                                               |
| 写缺失       |                        | 一个有效的缓存行被写入到不存在的内存区域。                                                                                                                                                                                    |
| 比较并交换   | Compare and Swap       | CAS 操作需要输入两个数值,一个旧值(期望操作前的值)和一个新值,在 期间先比较下在旧值有没有发生变化,如果没有发生变化,才交换成新值, 了变化则不交换                                                                                 |
| CPU 流水线   | CPU pipeline           | CPU 流水线的工作方式就象工业生产上的装配流水线,在 CPU 中由 5~6 个 功能的电路单元组成一条指令处理流水线,然后将一条 X86 指令分成 5~6 步 由这些电路单元分别执行,这样就能实现在一个 CPU 时钟周期完成一条指令 此 高 CPU 的运算速度 |
| 内存顺序冲突 | Memory order violation | 内存顺序冲突一般是由假共享引起,假共享是指多个 CPU 同时修改同一个缓存的不同部分而引起其中一个 CPU 的操作无效,当出现这个内存顺序冲突时, 必须清空流水线                                                                          |


## volatile

Volatile 变量修饰符如果使用恰当的话,它比 synchronized 的使用和执行成本会更低,因为它不会引起线程上下文的切换和调度。

volatile 变量修饰的共享变量，进行写操作的时候会多出一行汇编代码 （Java 代码转成汇编代码），即一个 Lock 前缀的指令（Lock# 信号），使得 CPU ：
* 当前处理器将当前缓存行的数据写入主内存  
* 其他 CPU 内缓存了该内存地址的数据无效  
笼统的说 CPU 通过缓存一致性机制确保修改的原子性，称为“缓存锁定”。  

Lock# 信号一般不锁总线，而是锁缓存，因为锁总线开销比较大。  

至于 CPU 如何发现缓存失效，以及如何处理缓存失效，是通过缓存一致性协议来解决的，这里不再详述。  
IA-32 和 Intel 64 处理器使用 MESI （修改、独占、共享、无效）控制协议维护内部缓存和其他 CPU 缓存的一致性。  

## synchronized

使用 monitorenter 和 monitorexit 指令实现，JVM 要保证每个 monitorenter 必须有对应的 monitorexit 与之配对。  
锁存在 Java 对象头里。如果对象是数组类型,则虚拟机用 3 个 Word(字宽)存储对象头,如果对象是非数组类型,则用 2 字宽存储对象头。
在 32 位虚拟机中,一字宽等于四字节,即 32bit。  
3个字宽分别存储：存储对象的 hashCode 或锁信息等; 存储到对象类型数据的指针； 数组的长度(如果当前对象是数组)。  

Java SE1.6 里锁一共有四种状态,无锁状态,偏向锁状态,轻量级锁状态和重量级锁状态,它会 随着竞争情况逐渐升级。  
锁可以升级但不能降级,意味着偏向锁升级成轻量级锁后不能降级成偏向锁，目的是为了 高获得锁和释放锁的效率。  

## 原子操作

32 位 IA-32 处理器使用基于对缓存加锁或总线加锁的方式来实现多处理器之间的原子操作。  

