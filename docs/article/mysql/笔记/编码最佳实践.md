
## 加什么锁

比如余额不足是怎么判断的，是通过异常的方式，还是通过查询的方式，如果是查询的方式那是不是要 for update。  

## 中间件设计

中间件需要怎么协调接口和会话，以及如何协调事务